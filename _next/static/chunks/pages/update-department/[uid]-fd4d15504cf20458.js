(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[626],{3457:function(e,r,t){"use strict";t.d(r,{Z:function(){return N}});var a=t(3366),n=t(7462),s=t(7294),o=t(6010),i=t(4780),d=t(948),l=t(1657),u=t(1588),c=t(4867);function m(e){return(0,c.Z)("MuiFormGroup",e)}(0,u.Z)("MuiFormGroup",["root","row","error"]);var p=t(4423),h=t(5704),g=t(5893);let x=["className","row"],f=e=>{let{classes:r,row:t,error:a}=e;return(0,i.Z)({root:["root",t&&"row",a&&"error"]},m,r)},Z=(0,d.ZP)("div",{name:"MuiFormGroup",slot:"Root",overridesResolver:(e,r)=>{let{ownerState:t}=e;return[r.root,t.row&&r.row]}})(({ownerState:e})=>(0,n.Z)({display:"flex",flexDirection:"column",flexWrap:"wrap"},e.row&&{flexDirection:"row"})),b=s.forwardRef(function(e,r){let t=(0,l.Z)({props:e,name:"MuiFormGroup"}),{className:s,row:i=!1}=t,d=(0,a.Z)(t,x),u=(0,p.Z)(),c=(0,h.Z)({props:t,muiFormControl:u,states:["error"]}),m=(0,n.Z)({},t,{row:i,error:c.error}),b=f(m);return(0,g.jsx)(Z,(0,n.Z)({className:(0,o.Z)(b.root,s),ownerState:m,ref:r},d))});var N=b},8654:function(e,r,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/update-department/[uid]",function(){return t(7495)}])},7495:function(e,r,t){"use strict";t.r(r);var a=t(5893),n=t(9008),s=t.n(n),o=t(1163),i=t(8482),d=t(6310),l=t(7357),u=t(6447),c=t(5861),m=t(135),p=t(3321),h=t(8334),g=t(3340),x=t(4054),f=t(3457),Z=t(480),b=t(5071),N=t(6815),v=t(6822),j=t(7294);let C=()=>{let e=(0,o.useRouter)(),r=(0,v.Z)(),[t,n]=(0,j.useState)(null),[h,C]=(0,j.useState)([]),{uid:w}=e.query,y=(0,i.TA)({initialValues:{departmentName:"",description:"",phoneNumber:"",address:"",departmentCategories:[],submit:null},validationSchema:d.Ry({departmentName:d.Z_().max(255).required("Department Name is required"),phoneNumber:d.Z_().max(20).required("Phone Number is required"),address:d.Z_().max(500).required("Address is required"),description:d.Z_().max(1e3),departmentCategories:d.IX().min(1,"Select at least one Department Category")}),onSubmit:async(t,a)=>{try{console.log(t);let{departmentName:a,description:n,phoneNumber:s,address:o,departmentCategories:i}=t,d={name:a,description:n,address:o,phoneNumber:s,categories:i};console.log(d),await r.patch("/api/v1/departments/".concat(w),d),e.push("/departments")}catch(e){console.error("Error updating department:",e),a.setStatus({success:!1}),a.setErrors({submit:"Error updating department."}),a.setSubmitting(!1)}}});return((0,j.useEffect)(()=>{let e=async()=>{try{let e=await r.get("/api/v1/departments/".concat(w));n(e.data)}catch(e){console.error("Error fetching department data:",e)}};e()},[w]),(0,j.useEffect)(()=>{let e=async()=>{try{let e=await r.get("/api/v1/categories"),t=e.data;C(t)}catch(e){console.error("Error fetching department categories:",e)}};e()},[]),(0,j.useEffect)(()=>{t&&y.setValues({departmentName:t.name,description:t.description||"",phoneNumber:t.phoneNumber,address:t.address,departmentCategories:t.categories.map(e=>e.id),submit:null})},[t,y]),t&&h.length)?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(s(),{children:(0,a.jsx)("title",{children:"Update Department"})}),(0,a.jsx)(l.Z,{sx:{flex:"1 1 auto",alignItems:"center",display:"flex",justifyContent:"center"},children:(0,a.jsx)(l.Z,{sx:{maxWidth:550,px:3,py:"100px",width:"100%"},children:(0,a.jsxs)("div",{children:[(0,a.jsx)(u.Z,{spacing:1,sx:{mb:3},children:(0,a.jsx)(c.Z,{variant:"h4",children:"Update Department"})}),(0,a.jsxs)("form",{noValidate:!0,onSubmit:y.handleSubmit,children:[(0,a.jsxs)(u.Z,{spacing:3,children:[(0,a.jsx)(m.Z,{error:!!(y.touched.departmentName&&y.errors.departmentName),fullWidth:!0,helperText:y.touched.departmentName&&y.errors.departmentName,label:"Department Name",name:"departmentName",onBlur:y.handleBlur,onChange:y.handleChange,value:y.values.departmentName}),(0,a.jsx)(m.Z,{error:!!(y.touched.description&&y.errors.description),fullWidth:!0,helperText:y.touched.description&&y.errors.description,label:"Description",name:"description",onBlur:y.handleBlur,onChange:y.handleChange,multiline:!0,rows:4,value:y.values.description}),(0,a.jsx)(m.Z,{error:!!(y.touched.phoneNumber&&y.errors.phoneNumber),fullWidth:!0,helperText:y.touched.phoneNumber&&y.errors.phoneNumber,label:"Phone Number",name:"phoneNumber",onBlur:y.handleBlur,onChange:y.handleChange,value:y.values.phoneNumber}),(0,a.jsx)(m.Z,{error:!!(y.touched.address&&y.errors.address),fullWidth:!0,helperText:y.touched.address&&y.errors.address,label:"Address",name:"address",onBlur:y.handleBlur,onChange:y.handleChange,value:y.values.address}),(0,a.jsx)(g.Z,{id:"department-category-label",children:"Department Categories"}),(0,a.jsxs)(x.Z,{fullWidth:!0,children:[(0,a.jsx)(f.Z,{children:h.map(e=>(0,a.jsx)(Z.Z,{control:(0,a.jsx)(b.Z,{checked:y.values.departmentCategories.includes(e.id),onChange:r=>{let t=r.target.checked;y.setFieldValue("departmentCategories",t?[...y.values.departmentCategories,e.id]:y.values.departmentCategories.filter(r=>r!==e.id))},name:"departmentCategories-".concat(e.id)}),label:e.name},e.id))}),y.touched.departmentCategories&&y.errors.departmentCategories&&(0,a.jsx)(N.Z,{error:!0,children:y.errors.departmentCategories})]})]}),y.errors.submit&&(0,a.jsx)(c.Z,{color:"error",sx:{mt:3},variant:"body2",children:y.errors.submit}),(0,a.jsx)(p.Z,{fullWidth:!0,size:"large",sx:{mt:3},type:"submit",variant:"contained",children:"Update Department"})]})]})})})]}):(0,a.jsx)("div",{children:"Loading..."})};C.getLayout=e=>(0,a.jsx)(h.A,{children:e}),r.default=C},6822:function(e,r,t){"use strict";var a=t(5121);let n=()=>{let e=a.Z.create({baseURL:"https://bettercity.mikita.dev",timeout:8e3,headers:{Authorization:"Bearer "+window.sessionStorage.getItem("token")}});return e};r.Z=n}},function(e){e.O(0,[60,230,410,703,121,28,333,435,334,774,888,179],function(){return e(e.s=8654)}),_N_E=e.O()}]);