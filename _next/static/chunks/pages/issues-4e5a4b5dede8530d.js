(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[765],{3569:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/issues",function(){return s(9749)}])},990:function(e,t,s){"use strict";s.d(t,{c:function(){return a}});var n=s(7294);let a=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],[t,s]=(0,n.useState)([]);(0,n.useEffect)(()=>{s([])},[e]);let a=(0,n.useCallback)(()=>{s([...e])},[e]),i=(0,n.useCallback)(e=>{s(t=>[...t,e])},[]),l=(0,n.useCallback)(()=>{s([])},[]),r=(0,n.useCallback)(e=>{s(t=>t.filter(t=>t!==e))},[]);return{handleDeselectAll:l,handleDeselectOne:r,handleSelectAll:a,handleSelectOne:i,selected:t}}},9749:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return H}});var n=s(5893),a=s(7294),i=s(9008),l=s.n(i),r=s(9140),c=s(7357),o=s(5582),d=s(6447),u=s(5861),h=s(4054),m=s(3321),p=s(3219),x=s(990),g=s(8334),j=s(5697),Z=s.n(j),f=s(6242),y=s(7906),b=s(3184),v=s(3816),S=s(8102),w=s(5071),C=s(295),k=s(3795),D=s(2613),N=s(9305),P=s(2377),I=s(4179),E=s(7556),O=s(9036);let _=e=>{let{count:t=0,items:s=[],onDeselectAll:a,onDeselectOne:i,onPageChange:l=()=>{},onRowsPerPageChange:r,onSelectAll:o,onSelectOne:h,page:m=0,rowsPerPage:p=0,selected:x=[]}=e,g=x.length>0&&x.length<s.length,j=s.length>0&&x.length===s.length,Z=e=>{switch(e){case"SOLVED":return(0,n.jsx)(I.Z,{});case"SOLVING":return(0,n.jsx)(E.Z,{});default:return(0,n.jsx)(O.Z,{})}};return(0,n.jsxs)(f.Z,{children:[(0,n.jsx)(P.L,{children:(0,n.jsx)(c.Z,{sx:{minWidth:800},children:(0,n.jsxs)(y.Z,{children:[(0,n.jsx)(b.Z,{children:(0,n.jsxs)(v.Z,{children:[(0,n.jsx)(S.Z,{padding:"checkbox",children:(0,n.jsx)(w.Z,{checked:j,indeterminate:g,onChange:e=>{e.target.checked?null==o||o():null==a||a()}})}),(0,n.jsx)(S.Z,{children:"Name"}),(0,n.jsx)(S.Z,{children:"Status"})]})}),(0,n.jsx)(C.Z,{children:s.map(e=>{let t=x.includes(e.id);return(0,n.jsxs)(v.Z,{component:k.Z,href:"/issues/".concat(e.id),hover:!0,selected:t,children:[(0,n.jsx)(S.Z,{padding:"checkbox",children:(0,n.jsx)(w.Z,{checked:t,onChange:t=>{t.target.checked?null==h||h(e.id):null==i||i(e.id)}})}),(0,n.jsx)(S.Z,{children:(0,n.jsx)(d.Z,{alignItems:"center",direction:"row",spacing:2,children:(0,n.jsx)(u.Z,{variant:"subtitle2",children:"#".concat(e.id," | ").concat(e.title)})})}),(0,n.jsx)(S.Z,{children:(0,n.jsx)(D.Z,{title:e.status,children:Z(e.status)})})]},e.id)})})]})})}),(0,n.jsx)(N.Z,{component:"div",count:t,onPageChange:l,onRowsPerPageChange:r,page:m,rowsPerPage:p,rowsPerPageOptions:[5,10,25]})]})};_.propTypes={count:Z().number,items:Z().array,onDeselectAll:Z().func,onDeselectOne:Z().func,onPageChange:Z().func,onRowsPerPageChange:Z().func,onSelectAll:Z().func,onSelectOne:Z().func,page:Z().number,rowsPerPage:Z().number,selected:Z().array};var U=s(9396),A=s(7709),L=s(7109);let W=()=>(0,n.jsx)(f.Z,{sx:{p:2},children:(0,n.jsx)(A.Z,{defaultValue:"",fullWidth:!0,placeholder:"Search issue",startAdornment:(0,n.jsx)(L.Z,{position:"start",children:(0,n.jsx)(p.Z,{color:"action",fontSize:"small",children:(0,n.jsx)(U.Z,{})})}),sx:{maxWidth:500}})});var z=s(8355),V=s(6703),R=s(3340),G=s(3599);s(2662);var T=s(6822);let B=[],M=(e,t)=>(0,a.useMemo)(()=>(0,z.i)(B,e,t),[e,t]),X=e=>(0,a.useMemo)(()=>e.map(e=>e.id),[e]),F=()=>{let e;let t=(0,T.Z)(),[s,i]=(0,a.useState)(null),[g,j]=(0,a.useState)([]),[Z,f]=(0,a.useState)([]),[y,b]=(0,a.useState)([]),[v,S]=(0,a.useState)([]),[w,C]=(0,a.useState)(0),[k,D]=(0,a.useState)(5),[N,P]=(0,a.useState)(""),[I,E]=(0,a.useState)(""),[O,U]=(0,a.useState)(""),A=M(w,k),L=X(A),z=(0,x.c)(L),B=(0,a.useCallback)((e,t)=>{C(t)},[]),F=(0,a.useCallback)(e=>{D(e.target.value)},[]),H=e=>{let{name:t,value:s}=e.target;"status"===t&&P(s),"department"===t&&(""!=s&&Q(s),E(s)),"employee"===t&&(""!=s&&Y(s),U(s))},q=async()=>{try{let e=await t.get("/api/v1/issues"),s=e.data.issues.map(e=>({id:e.id,photo:e.photo,coordinates:{latitude:e.coordinates.latitude,longitude:e.coordinates.longitude},description:e.description,title:e.title,authorUid:e.authorUid,categoryId:e.categoryId,creationDate:e.creationDate,status:e.status,likeCount:e.likeCount}));i(s)}catch(e){console.error("Error fetching issues:",e)}},J=async()=>{try{let e=await t.get("/api/v1/services/me/departments"),s=e.data.departments.map(e=>({address:e.address,categories:e.categories,creationDate:e.creationDate,description:e.description,name:e.name,phoneNumber:e.phoneNumber,uid:e.uid}));b(s)}catch(e){console.error("Error fetching departments:",e)}},K=async()=>{try{let e=await t.get("/api/v1/services/me/employees"),s=e.data.employees.map(e=>({uid:e.uid,email:e.email,firstName:e.firstName,lastName:e.lastName,phoneNumber:e.phoneNumber,departmentUid:e.departmentUid,creationDate:e.creationDate}));S(s)}catch(e){console.error("Error fetching employees:",e)}},Q=async e=>{try{let s=await t.get("/api/v1/issues/department/"+e),n=s.data.issues.map(e=>({id:e.id,photo:e.photo,coordinates:{latitude:e.coordinates.latitude,longitude:e.coordinates.longitude},description:e.description,title:e.title,authorUid:e.authorUid,categoryId:e.categoryId,creationDate:e.creationDate,status:e.status,likeCount:e.likeCount}));j(n)}catch(e){console.error("Error fetching issues by department:",e)}},Y=async e=>{try{let s=await t.get("/api/v1/issues/employee/"+e),n=s.data.issues.map(e=>({id:e.id,photo:e.photo,coordinates:{latitude:e.coordinates.latitude,longitude:e.coordinates.longitude},description:e.description,title:e.title,authorUid:e.authorUid,categoryId:e.categoryId,creationDate:e.creationDate,status:e.status,likeCount:e.likeCount}));f(n)}catch(e){console.error("Error fetching issues by employee:",e)}};return(0,a.useEffect)(()=>{let e=async()=>{await q(),await J(),await K()};e()},[]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(l(),{children:(0,n.jsx)("title",{children:"Issues"})}),(0,n.jsx)(c.Z,{component:"main",sx:{flexGrow:1,py:8},children:(0,n.jsx)(o.Z,{maxWidth:"xl",children:(0,n.jsxs)(d.Z,{spacing:3,children:[(0,n.jsx)(d.Z,{direction:"row",justifyContent:"space-between",spacing:4,children:(0,n.jsxs)(d.Z,{spacing:1,children:[(0,n.jsx)(u.Z,{variant:"h4",children:"Issues"}),(0,n.jsxs)(d.Z,{alignItems:"center",direction:"row",spacing:1,children:[(0,n.jsxs)(h.Z,{sx:{m:1,minWidth:120},size:"small",children:[(0,n.jsx)(R.Z,{id:"select-status-label",children:"Status"}),(0,n.jsxs)(V.Z,{labelId:"select-status-label",id:"select-status",value:N,label:"Status",name:"status",onChange:H,children:[(0,n.jsx)(G.Z,{value:"",children:(0,n.jsx)("em",{children:"None"})}),(0,n.jsx)(G.Z,{value:"PUBLISHED",children:"Published"}),(0,n.jsx)(G.Z,{value:"SOLVING",children:"Solving"}),(0,n.jsx)(G.Z,{value:"SOLVED",children:"Solved"})]})]}),(0,n.jsxs)(h.Z,{sx:{m:1,minWidth:120},size:"small",children:[(0,n.jsx)(R.Z,{id:"select-status-label",children:"Department"}),(0,n.jsxs)(V.Z,{labelId:"select-department-label",id:"select-department",value:I,label:"Department",name:"department",onChange:H,children:[(0,n.jsx)(G.Z,{value:"",children:(0,n.jsx)("em",{children:"None"})}),y.map(e=>(0,n.jsx)(G.Z,{value:e.uid,children:e.name},e.uid))]})]}),(0,n.jsxs)(h.Z,{sx:{m:1,minWidth:120},size:"small",children:[(0,n.jsx)(R.Z,{id:"select-status-label",children:"Employee"}),(0,n.jsxs)(V.Z,{labelId:"select-employee-label",id:"select-employee",value:O,label:"Employee",name:"employee",onChange:H,children:[(0,n.jsx)(G.Z,{value:"",children:(0,n.jsx)("em",{children:"None"})}),v.map(e=>(0,n.jsxs)(G.Z,{value:e.uid,children:[e.firstName," ",e.lastName]},e.uid))]})]}),(0,n.jsx)(m.Z,{color:"inherit",startIcon:(0,n.jsx)(p.Z,{fontSize:"small",children:(0,n.jsx)(r.Z,{})}),href:"/issue-map",children:"Show on map"})]})]})}),(0,n.jsx)(W,{}),(0,n.jsx)(_,{count:s?s.length:0,items:s?(e=[...s],N&&(e=e.filter(e=>e.status===N)),I&&(e=e.filter(e=>g.some(t=>t.id===e.id))),O&&(e=e.filter(e=>Z.some(t=>t.id===e.id))),e):[],onDeselectAll:z.handleDeselectAll,onDeselectOne:z.handleDeselectOne,onPageChange:B,onRowsPerPageChange:F,onSelectAll:z.handleSelectAll,onSelectOne:z.handleSelectOne,page:w,rowsPerPage:k,selected:z.selected})]})})})]})};F.getLayout=e=>(0,n.jsx)(g.A,{children:e});var H=F},6822:function(e,t,s){"use strict";var n=s(5121);let a=()=>{let e=n.Z.create({baseURL:"https://bettercity.mikita.dev",timeout:8e3,headers:{Authorization:"Bearer "+window.sessionStorage.getItem("token")}});return e};t.Z=a},8355:function(e,t,s){"use strict";function n(e,t,s){return e.slice(t*s,t*s+s)}s.d(t,{i:function(){return n}})}},function(e){e.O(0,[60,230,410,703,121,28,146,612,334,774,888,179],function(){return e(e.s=3569)}),_N_E=e.O()}]);