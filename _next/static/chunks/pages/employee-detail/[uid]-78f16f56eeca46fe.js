(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[515],{4174:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/employee-detail/[uid]",function(){return s(6676)}])},7309:function(e,t,s){"use strict";s.d(t,{k:function(){return c}});var a=s(7297),n=s(5152),i=s.n(n),r=s(948);function l(){let e=(0,a.Z)([""]);return l=function(){return e},e}let o=i()(()=>Promise.all([s.e(279),s.e(229)]).then(s.bind(s,7229)),{loadableGenerated:{webpack:()=>[7229]},ssr:!1,loading:()=>null}),c=(0,r.ZP)(o)(l())},6676:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return z}});var a=s(5893),n=s(7294),i=s(6886),r=s(6242),l=s(4267),o=s(5861),c=s(7357),d=s(5582),h=s(8334),u=s(5697),x=s.n(u),p=s(1929),m=s(3219),y=s(8445),j=s(9661),Z=s(6447),g=s(7309),f=s(940),w=s(55),v=s(1088);let S=()=>{let e=(0,p.Z)();return{chart:{background:"transparent"},colors:[e.palette.success.main,e.palette.warning.main],dataLabels:{enabled:!1},labels:["Solved","Solving"],legend:{show:!1},plotOptions:{pie:{expandOnClick:!1}},states:{active:{filter:{type:"none"}},hover:{filter:{type:"none"}}},stroke:{width:0},theme:{mode:e.palette.mode},tooltip:{fillSeriesColor:!1}}},b={Solved:(0,a.jsx)(m.Z,{style:{color:"#10B981"},children:(0,a.jsx)(w.Z,{})}),Solving:(0,a.jsx)(m.Z,{style:{color:"#F79009"},children:(0,a.jsx)(f.Z,{})})},k=e=>{let{chartSeries:t,sx:s}=e,n=S();return(0,a.jsxs)(r.Z,{sx:s,children:[(0,a.jsx)(y.Z,{avatar:(0,a.jsx)(j.Z,{sx:{backgroundColor:"success.main",height:56,width:56,paddingBottom:0},children:(0,a.jsx)(m.Z,{children:(0,a.jsx)(v.Z,{})})}),title:"This month's issues & their statuses"}),(0,a.jsxs)(l.Z,{children:[(0,a.jsx)(g.k,{height:300,options:n,series:t,type:"donut",width:"100%"}),(0,a.jsx)(Z.Z,{alignItems:"center",direction:"row",justifyContent:"center",spacing:2,sx:{mt:2},children:t.map((e,t)=>{let s=n.labels[t];return(0,a.jsxs)(c.Z,{sx:{display:"flex",flexDirection:"column",alignItems:"center"},children:[b[s],(0,a.jsx)(o.Z,{sx:{my:1},variant:"h6",children:s}),(0,a.jsx)(o.Z,{color:"text.secondary",variant:"subtitle2",children:e})]},s)})})]})]})};k.propTypes={chartSeries:x().array.isRequired,sx:x().object};var P=s(7344),N=s(9008),D=s.n(N),C=s(6207),M=s(3321),O=s(1796),L=s(4855);let T=()=>{let e=(0,p.Z)();return{chart:{background:"transparent",stacked:!1,toolbar:{show:!1}},colors:[e.palette.primary.main,(0,O.Fq)(e.palette.primary.main,.25)],dataLabels:{enabled:!1},fill:{opacity:1,type:"solid"},grid:{borderColor:e.palette.divider,strokeDashArray:2,xaxis:{lines:{show:!1}},yaxis:{lines:{show:!0}}},legend:{show:!1},plotOptions:{bar:{columnWidth:"40px"}},stroke:{colors:["transparent"],show:!0,width:2},theme:{mode:e.palette.mode},xaxis:{axisBorder:{color:e.palette.divider,show:!0},axisTicks:{color:e.palette.divider,show:!0},categories:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],labels:{offsetY:5,style:{colors:e.palette.text.secondary}}},yaxis:{labels:{formatter:e=>"".concat(e),offsetX:-10,style:{colors:e.palette.text.secondary}}}}},E=e=>{let{chartSeries:t,sx:s}=e,n=T();return(0,a.jsxs)(r.Z,{sx:s,children:[(0,a.jsx)(y.Z,{avatar:(0,a.jsx)(j.Z,{sx:{backgroundColor:"info.main",height:56,width:56,paddingBottom:0},children:(0,a.jsx)(m.Z,{children:(0,a.jsx)(L.Z,{})})}),action:(0,a.jsx)(M.Z,{color:"inherit",size:"small",startIcon:(0,a.jsx)(m.Z,{fontSize:"small",children:(0,a.jsx)(C.Z,{})}),children:"Sync"}),title:"Solved issues per month"}),(0,a.jsx)(l.Z,{children:(0,a.jsx)(g.k,{height:350,options:n,series:t,type:"bar",width:"100%"})})]})};E.protoTypes={chartSeries:x().array.isRequired,sx:x().object},s(2662);var _=s(6822),I=s(2912),Y=s(3703),R=s(7844),B=s(1163);let F=()=>{let e=(0,B.useRouter)(),{uid:t}=e.query,s=(0,_.Z)(),[h,u]=(0,n.useState)(null),[x,p]=(0,n.useState)([]),[m,y]=(0,n.useState)({solved:0,solving:0}),[j,Z]=(0,n.useState)({thisYear:[],lastYear:[]}),g=async()=>{try{let e=await s.get("/api/v1/employees/".concat(t)),a=await s.get("/api/v1/departments/".concat(e.data.departmentUid)),n=await s.get("/api/v1/issues/employee/".concat(e.data.uid,"/count?statuses=SOLVED"));u({departmentUid:e.data.departmentUid,email:e.data.email,firstName:e.data.firstName,lastName:e.data.lastName,phoneNumber:e.data.phoneNumber,uid:e.data.uid,departmentName:a.data.name,issuesCount:n.data.count})}catch(e){console.log(e)}},f=async()=>{try{let e=await s.get("/api/v1/issues/employee/".concat(h.uid)),t=e.data.issues,a=t.map(e=>({id:e.id,name:e.title,description:e.description,longitude:e.coordinates.longitude,latitude:e.coordinates.latitude,dateOfCreation:e.creationDate,status:e.status}));p(a)}catch(e){console.log(e)}},w=async()=>{try{let e=(0,I.Z)((0,Y.Z)(new Date),"yyyy-MM-dd"),t=await s.get("/api/v1/issues/employee/".concat(h.uid,"/count?from=").concat(e,"&statuses=SOLVED")),a=await s.get("/api/v1/issues/employee/".concat(h.uid,"/count?from=").concat(e,"&statuses=SOLVING")),n=t.data.count,i=a.data.count;y({solved:n,solving:i})}catch(e){console.log(e)}},v=async()=>{try{let e=new Date().getFullYear(),t=e-1,a=Array.from({length:12},(e,t)=>t),n=a.map(async t=>{let a=(0,I.Z)(new Date(e,t,1),"yyyy-MM-dd"),n=(0,I.Z)((0,R.Z)(new Date(e,t)),"yyyy-MM-dd"),i=await s.get("/api/v1/solutions/employee/".concat(h.uid,"/count?from=").concat(a,"&to=").concat(n));return i.data.count}),i=a.map(async e=>{let a=(0,I.Z)(new Date(t,e,1),"yyyy-MM-dd"),n=(0,I.Z)((0,R.Z)(new Date(t,e)),"yyyy-MM-dd"),i=await s.get("/api/v1/solutions/employee/".concat(h.uid,"/count?from=").concat(a,"&to=").concat(n));return i.data.count}),[r,l]=await Promise.all([Promise.all(n),Promise.all(i)]);Z({thisYear:r,lastYear:l})}catch(e){console.log(e)}};return(0,n.useEffect)(()=>{let e=async()=>{t&&await g()};e()},[t]),(0,n.useEffect)(()=>{h&&(f(),w(),v())},[h]),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(D(),{children:(0,a.jsx)("title",{children:"Employee detail"})}),(0,a.jsx)(i.ZP,{container:!0,spacing:3,children:(0,a.jsx)(i.ZP,{item:!0,xs:12,children:(0,a.jsx)(r.Z,{children:(0,a.jsx)(l.Z,{children:(0,a.jsxs)(o.Z,{variant:"h5",children:[" ",h?h.firstName+" "+h.lastName:null]})})})})}),(0,a.jsx)(c.Z,{component:"main",sx:{flexGrow:1,py:8},children:(0,a.jsx)(d.Z,{maxWidth:"xl",children:(0,a.jsxs)(i.ZP,{container:!0,spacing:3,children:[(0,a.jsx)(i.ZP,{xs:12,sm:6,lg:4,children:(0,a.jsx)(r.Z,{children:(0,a.jsxs)(l.Z,{children:[(0,a.jsx)(o.Z,{variant:"h5",children:"Basic information"}),(0,a.jsxs)(o.Z,{variant:"body1",children:["Email: ",h?h.email:null," "]}),(0,a.jsxs)(o.Z,{variant:"body1",children:["Phone: ",h?h.phoneNumber:null," "]}),(0,a.jsxs)(o.Z,{variant:"body1",children:["Department: ",h?h.departmentName:null," "]}),(0,a.jsxs)(o.Z,{variant:"body1",children:["Resolved Issues: ",h?h.issuesCount:null," "]})]})})}),(0,a.jsx)(i.ZP,{xs:12,md:12,lg:8,children:(0,a.jsx)(P.n,{issues:x,sx:{height:"100%"}})}),(0,a.jsx)(i.ZP,{xs:12,lg:8,children:(0,a.jsx)(E,{chartSeries:[{name:"This year",data:j.thisYear},{name:"Last year",data:j.lastYear}],sx:{height:"100%"}})}),(0,a.jsx)(i.ZP,{xs:12,md:6,lg:4,children:(0,a.jsx)(k,{chartSeries:[m.solved,m.solving],labels:["Solved","Solving"],sx:{height:"100%"}})})]})})})]})};F.getLayout=e=>(0,a.jsx)(h.A,{children:e});var z=F},7344:function(e,t,s){"use strict";s.d(t,{n:function(){return M}});var a=s(5893),n=s(7294),i=s(5697),r=s.n(i),l=s(2743),o=s(6242),c=s(8445),d=s(9661),h=s(3219),u=s(7357),x=s(7906),p=s(3184),m=s(3816),y=s(8102),j=s(295),Z=s(9305),g=s(7720),f=s(2023),w=s(3321),v=s(2377),S=s(948);let b=(0,S.ZP)("span")(e=>{let{theme:t,ownerState:s}=e,a=t.palette[s.color].alpha12,n="dark"===t.palette.mode?t.palette[s.color].main:t.palette[s.color].dark;return{alignItems:"center",backgroundColor:a,borderRadius:12,color:n,cursor:"default",display:"inline-flex",flexGrow:0,flexShrink:0,fontFamily:t.typography.fontFamily,fontSize:t.typography.pxToRem(12),lineHeight:2,fontWeight:600,justifyContent:"center",letterSpacing:.5,minWidth:20,paddingLeft:t.spacing(1),paddingRight:t.spacing(1),textTransform:"uppercase",whiteSpace:"nowrap"}}),k=e=>{let{color:t="primary",children:s,...n}=e;return(0,a.jsx)(b,{ownerState:{color:t},...n,children:s})};k.propTypes={children:r().node,color:r().oneOf(["primary","secondary","error","info","warning","success"])};var P=s(1590),N=s(950),D=s(2912);let C={SOLVING:"warning",SOLVED:"success"},M=e=>{let{issues:t=[],sx:s}=e,[i,r]=(0,n.useState)(0),S=(e,t)=>{r(t)},b=t.slice(5*i,5*i+5),M=e=>{let t=(0,N.Z)(e,"yyyy-MM-dd'T'HH:mm:ss.SSSSSS",new Date);return t};return(0,a.jsxs)(o.Z,{sx:s,children:[(0,a.jsx)(c.Z,{avatar:(0,a.jsx)(d.Z,{sx:{backgroundColor:"warning.main",height:56,width:56,paddingBottom:0},children:(0,a.jsx)(h.Z,{children:(0,a.jsx)(P.Z,{})})}),title:"Your latest Issues"}),(0,a.jsx)(v.L,{sx:{flexGrow:1},children:(0,a.jsx)(u.Z,{sx:{minWidth:800,paddingTop:0},children:(0,a.jsxs)(x.Z,{children:[(0,a.jsx)(p.Z,{children:(0,a.jsxs)(m.Z,{children:[(0,a.jsx)(y.Z,{children:" Issue Nr. "}),(0,a.jsx)(y.Z,{children:" What happened "}),(0,a.jsx)(y.Z,{children:" Location "}),(0,a.jsx)(y.Z,{sortDirection:"desc",children:" Date "}),(0,a.jsx)(y.Z,{children:" Status "})]})}),(0,a.jsx)(j.Z,{children:b.map(e=>{let t=(0,D.Z)(M(e.dateOfCreation),"dd/MM/yyyy");return(0,a.jsxs)(m.Z,{hover:!0,children:[(0,a.jsxs)(y.Z,{children:[" ",e.id," "]}),(0,a.jsxs)(y.Z,{children:[" ",e.name," "]}),(0,a.jsxs)(y.Z,{children:[" ",e.latitude,", ",e.longitude," "]}),(0,a.jsxs)(y.Z,{children:[" ",t," "]}),(0,a.jsx)(y.Z,{children:(0,a.jsx)(k,{color:C[e.status],children:e.status})})]},e.id)})})]})})}),(0,a.jsx)(Z.Z,{component:"div",count:t.length,rowsPerPage:5,page:i,onPageChange:S,rowsPerPageOptions:[]}),(0,a.jsx)(g.Z,{}),(0,a.jsx)(f.Z,{sx:{justifyContent:"flex-end"},children:(0,a.jsx)(w.Z,{color:"inherit",endIcon:(0,a.jsx)(h.Z,{fontSize:"small",children:(0,a.jsx)(l.Z,{})}),size:"small",variant:"text",children:"View all"})})]})};M.propTypes={issues:r().array,sx:r().object}},6822:function(e,t,s){"use strict";var a=s(5121);let n=()=>{let e=a.Z.create({baseURL:"https://bettercity.mikita.dev",timeout:8e3,headers:{Authorization:"Bearer "+window.sessionStorage.getItem("token")}});return e};t.Z=n}},function(e){e.O(0,[60,230,410,703,121,146,723,854,334,774,888,179],function(){return e(e.s=4174)}),_N_E=e.O()}]);